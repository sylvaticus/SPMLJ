<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>0201 - Wranging data · SPMLJ</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-Q39LHCRBB6"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-Q39LHCRBB6', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">SPMLJ</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Index</a></li><li><span class="tocitem">Lessons</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">INTRO - Introduction to the course, Julia and ML</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0001_-_Course_presentation.html">0001 - Course presentation</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0002_-_Program.html">0002 - Program</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0003_-_Introduction_to_Julia.html">0003 - Introduction to Julia</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004_-_Introduction_to_ML.html">0004 - Introduction to ML</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004q_-_QUIZ_0.1.html">0004q - QUIZ 0.1</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0005_-_How_to_install_Julia_and_git.html">0005 - How to install Julia and git</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0006_-_Modules_packages_and_environments.html">0006 - Modules packages and environments</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">JULIA1 - Basic Julia programming</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101_-_Basic_syntax.html">0101 - Basic syntax</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101q_-_QUIZ_1.1.html">0101q - QUIZ 1.1</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101q_-_QUIZ_1.2.html">0101q - QUIZ 1.2</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0102_-_Types_and_objects.html">0102 - Types and objects</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0102q_-_QUIZ_1.3.html">0102q - QUIZ 1.3</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103_-_Predefined_types.html">0103 - Predefined types</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.4.html">0103q - QUIZ 1.4</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.5.html">0103q - QUIZ 1.5</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.6.html">0103q - QUIZ 1.6</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104_-_Control_flow_and_functions.html">0104 - Control flow and functions</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104q_-_QUIZ_1.7.html">0104q - QUIZ 1.7</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104q_-_QUIZ_1.8.html">0104q - QUIZ 1.8</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105_-_Custom_types.html">0105 - Custom types</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105q_-_QUIZ_1.10.html">0105q - QUIZ 1.10</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105q_-_QUIZ_1.9.html">0105q - QUIZ 1.9</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.html">0105x EXERCISE-1.1</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106_-_Further_topics.html">0106 - Further topics</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.11.html">0106q - QUIZ 1.11</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.12.html">0106q - QUIZ 1.12</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.13.html">0106q - QUIZ 1.13</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">JULIA2 - Scientific programming with Julia</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href="0201_-_Wranging_data.html">0201 - Wranging data</a><ul class="internal"><li><a class="tocitem" href="#Some-stuff-to-set-up-the-environment.."><span>Some stuff to set-up the environment..</span></a></li><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Data-import"><span>Data import</span></a></li><li><a class="tocitem" href="#Getting-insights-on-the-data"><span>Getting insights on the data</span></a></li><li><a class="tocitem" href="#Selection-and-querying-data"><span>Selection and querying data</span></a></li><li><a class="tocitem" href="#Editing-data"><span>Editing data</span></a></li><li><a class="tocitem" href="#Work-on-dataframe-structure"><span>Work on dataframe structure</span></a></li><li><a class="tocitem" href="#Pivoting-data"><span>Pivoting data</span></a></li><li><a class="tocitem" href="#The-Split-Apply-Combine-strategy"><span>The Split-Apply-Combine strategy</span></a></li><li><a class="tocitem" href="#Export-and-saving"><span>Export and saving</span></a></li></ul></li><li><a class="tocitem" href="0202_-_Miscellaneous_topics.html">0202 - Miscellaneous topics</a></li><li><a class="tocitem" href="0202x_EXERCISE-2.1.html">0202x EXERCISE-2.1</a></li><li><a class="tocitem" href="0202x_EXERCISE-2.2.html">0202x EXERCISE-2.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">ML1 - Introduction to Machine Learning</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0301_-_Machine_learning_main_concepts.html">0301 - Machine learning main concepts</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302_-_The_Perceptron_classifier.html">0302 - The Perceptron classifier</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302x_EXERCISE-3.1.html">0302x EXERCISE-3.1</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">NN - Neural Networks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0401_-_Neural_network_architectures.html">0401 - Neural network architectures</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402_-_Implementation_of_neural_networks_workflows.html">0402 - Implementation of neural networks workflows</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.1.html">0402x EXERCISE-4.1</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.2.html">0402x EXERCISE-4.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">DT - Decision trees based algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0501_-_Decision_trees_based_algorithms.html">0501 - Decision trees based algorithms</a></li><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0502x_EXERCISE-5.1.html">0502x EXERCISE-5.1</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Lessons</a></li><li><a class="is-disabled">JULIA2 - Scientific programming with Julia</a></li><li class="is-active"><a href="0201_-_Wranging_data.html">0201 - Wranging data</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="0201_-_Wranging_data.html">0201 - Wranging data</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sylvaticus/SPMLJ/blob/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/0201_-_Wranging_data.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><pre></pre><h1 id="Data-Wrangling"><a class="docs-heading-anchor" href="#Data-Wrangling">0201 - Data Wrangling</a><a id="Data-Wrangling-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Wrangling" title="Permalink"></a></h1><h2 id="Some-stuff-to-set-up-the-environment.."><a class="docs-heading-anchor" href="#Some-stuff-to-set-up-the-environment..">Some stuff to set-up the environment..</a><a id="Some-stuff-to-set-up-the-environment..-1"></a><a class="docs-heading-anchor-permalink" href="#Some-stuff-to-set-up-the-environment.." title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; cd(@__DIR__)</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Pkg</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Pkg.activate(&quot;.&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">  Activating project at `~/work/SPMLJ/SPMLJ/buildedDoc/02_-_JULIA2_-_Scientific_programming_with_Julia`</code></pre><p>If using a Julia version different than 1.7 please uncomment and run the following line (reproductibility guarantee will hower be lost) Pkg.resolve()</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; Pkg.instantiate()</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Random</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; Random.seed!(123)</code><code class="nohighlight hljs ansi" style="display:block;">Random.TaskLocalRNG()</code></pre><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>This segment will be mostly based on <a href="https://github.com/JuliaData/DataFrames.jl">DataFrames</a> and related packages</p><p>!!! info DataFrames vs Matrix     DataFrames are popular format for <strong>in-memory tabular data</strong>. Their main advantages over Arrays are that they can efficiently store different types of data on each column (indeed each column is a wrapper over an <code>Array{T,1}</code> where <code>T</code> is specific to each column) and, thanks also to their named columns, provide convenient API for data operations, like indexing, querying , joining, split-apply-combine, etc.</p><div class="admonition is-info"><header class="admonition-header">Info</header><div class="admonition-body"><p>In most circunstances we can refer to dataframe columns either by using their name as a string, e.g. <code>&quot;Region&quot;</code>, or as symbol, e.g. <code>:Region</code>. In the rest of the segment we will use the strings approach.</p></div></div><h2 id="Data-import"><a class="docs-heading-anchor" href="#Data-import">Data import</a><a id="Data-import-1"></a><a class="docs-heading-anchor-permalink" href="#Data-import" title="Permalink"></a></h2><p>Our example: Forest volumes and area by country and year Source: Eurostat; units: forarea: Milion hectars, forvol: Milion cubic metres</p><h3 id="Built-in-solution:-CSV-–-Matrix"><a class="docs-heading-anchor" href="#Built-in-solution:-CSV-–-Matrix">Built-in solution: CSV –&gt; Matrix</a><a id="Built-in-solution:-CSV-–-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Built-in-solution:-CSV-–-Matrix" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DelimitedFiles  # in the stdlib</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = convert(Array{Float64,2},readdlm(&quot;data.csv&quot;,&#39;;&#39;)[2:end,3:end]) # Skip the first 1 row and the first 2 columns - out is a Matrix</code><code class="nohighlight hljs ansi" style="display:block;">8×2 Matrix{Float64}:
 11.354    3381.0
 15.288    2254.28
  8.36925  1058.71
 28.163    3184.67
 11.419    3663.0
 17.253    3055.83
  9.56613  1424.4
 27.98     3653.91</code></pre><h3 id="CSV.jl:-{CSV-file,-hardwritten-data}-–-DataFrame"><a class="docs-heading-anchor" href="#CSV.jl:-{CSV-file,-hardwritten-data}-–-DataFrame">CSV.jl: {CSV file, hardwritten data} –&gt; DataFrame</a><a id="CSV.jl:-{CSV-file,-hardwritten-data}-–-DataFrame-1"></a><a class="docs-heading-anchor-permalink" href="#CSV.jl:-{CSV-file,-hardwritten-data}-–-DataFrame" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using CSV, DataFrames</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = CSV.read(&quot;data.csv&quot;,DataFrame) # source, sink, kword options</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String7  Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = CSV.read(&quot;data.csv&quot;,NamedTuple)</code><code class="nohighlight hljs ansi" style="display:block;">(Country = InlineStrings.String7[&quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;, &quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;], Year = [2000, 2000, 2000, 2000, 2020, 2020, 2020, 2020], forarea = [11.354, 15.288, 8.36925, 28.163, 11.419, 17.253, 9.56613, 27.98], forvol = [3381.0, 2254.28, 1058.71, 3184.67, 3663.0, 3055.83, 1424.4, 3653.91])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = CSV.read(IOBuffer(&quot;&quot;&quot;
       Country	Year	forarea	forvol
       Germany	2000	11.354	3381
       France	2000	15.288	2254.28
       Italy	2000	8.36925	1058.71
       Sweden	2000	28.163	3184.67
       Germany	2020	11.419	3663
       France	2020	17.253	3055.83
       Italy	2020	9.56613	1424.4
       Sweden	2020	27.98	3653.91
       &quot;&quot;&quot;), DataFrame, copycols=true)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String7  Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code></pre><p>Some common CSV.jl options: <code>delim</code> (use <code>&#39;\t&#39;</code> for tab delimited files), <code>quotechar</code>, <code>openquotechar</code>, <code>closequotechar</code>, <code>escapechar</code>, <code>missingstring</code>, <code>dateformat</code>, <code>append</code>, <code>writeheader</code>, <code>header</code>, <code>newline</code>, <code>quotestrings</code>, <code>decimal</code>, <code>header</code>, <code>normalizenames</code>, <code>datarow</code>, <code>skipto</code>, <code>footerskip</code>, <code>limit</code>, <code>transpose</code>, <code>comment</code>, <code>use_mmap</code>, <code>type</code>, <code>types</code> (e.g. <code>types=Dict(&quot;fieldFoo&quot; =&gt; Union{Missing,Int64})</code>), <code>typemap</code>, <code>pool</code>, <code>categorical</code>, <code>strict</code>, <code>silencewarnings</code>, <code>ignorerepeated</code></p><h3 id="XLSX.jl:-xlsx-{Matrix,-DataFrame}"><a class="docs-heading-anchor" href="#XLSX.jl:-xlsx-{Matrix,-DataFrame}">XLSX.jl: xlsx -&gt; {Matrix, DataFrame}</a><a id="XLSX.jl:-xlsx-{Matrix,-DataFrame}-1"></a><a class="docs-heading-anchor-permalink" href="#XLSX.jl:-xlsx-{Matrix,-DataFrame}" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using XLSX</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sheetNames = XLSX.sheetnames(XLSX.readxlsx(&quot;data.xlsx&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">1-element Vector{String}:
 &quot;Sheet1&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = XLSX.readxlsx(&quot;data.xlsx&quot;)[&quot;Sheet1&quot;][&quot;A1:D9&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">9×4 Matrix{Any}:
 &quot;Country&quot;      &quot;Year&quot;    &quot;forarea&quot;      &quot;forvol&quot;
 &quot;Germany&quot;  2000        11.354       3381
 &quot;France&quot;   2000        15.288       2254.28
 &quot;Italy&quot;    2000         8.36925     1058.71
 &quot;Sweden&quot;   2000        28.163       3184.67
 &quot;Germany&quot;  2020        11.419       3663
 &quot;France&quot;   2020        17.253       3055.83
 &quot;Italy&quot;    2020         9.56613     1424.4
 &quot;Sweden&quot;   2020        27.98        3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = XLSX.readxlsx(&quot;data.xlsx&quot;)[&quot;Sheet1&quot;][:]</code><code class="nohighlight hljs ansi" style="display:block;">9×4 Matrix{Any}:
 &quot;Country&quot;      &quot;Year&quot;    &quot;forarea&quot;      &quot;forvol&quot;
 &quot;Germany&quot;  2000        11.354       3381
 &quot;France&quot;   2000        15.288       2254.28
 &quot;Italy&quot;    2000         8.36925     1058.71
 &quot;Sweden&quot;   2000        28.163       3184.67
 &quot;Germany&quot;  2020        11.419       3663
 &quot;France&quot;   2020        17.253       3055.83
 &quot;Italy&quot;    2020         9.56613     1424.4
 &quot;Sweden&quot;   2020        27.98        3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = XLSX.readdata(&quot;data.xlsx&quot;, &quot;Sheet1&quot;, &quot;A1:D9&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">9×4 Matrix{Any}:
 &quot;Country&quot;      &quot;Year&quot;    &quot;forarea&quot;      &quot;forvol&quot;
 &quot;Germany&quot;  2000        11.354       3381
 &quot;France&quot;   2000        15.288       2254.28
 &quot;Italy&quot;    2000         8.36925     1058.71
 &quot;Sweden&quot;   2000        28.163       3184.67
 &quot;Germany&quot;  2020        11.419       3663
 &quot;France&quot;   2020        17.253       3055.83
 &quot;Italy&quot;    2020         9.56613     1424.4
 &quot;Sweden&quot;   2020        27.98        3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; XLSX.readtable(&quot;data.xlsx&quot;, &quot;Sheet1&quot;) # tuple vector of (data) vectors, vector of symbols, usable as DF constructor</code><code class="nohighlight hljs ansi" style="display:block;">(Any[Any[&quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;, &quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;], Any[2000, 2000, 2000, 2000, 2020, 2020, 2020, 2020], Any[11.354, 15.288, 8.36925, 28.163, 11.419, 17.253, 9.56613, 27.98], Any[3381, 2254.28, 1058.71, 3184.67, 3663, 3055.83, 1424.4, 3653.91]], [:Country, :Year, :forarea, :forvol])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = DataFrame(XLSX.readtable(&quot;data.xlsx&quot;, &quot;Sheet1&quot;)...)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year  forarea  forvol
     │ Any      Any   Any      Any
─────┼─────────────────────────────────
   1 │ Germany  2000  11.354   3381
   2 │ France   2000  15.288   2254.28
   3 │ Italy    2000  8.36925  1058.71
   4 │ Sweden   2000  28.163   3184.67
   5 │ Germany  2020  11.419   3663
   6 │ France   2020  17.253   3055.83
   7 │ Italy    2020  9.56613  1424.4
   8 │ Sweden   2020  27.98    3653.91</code></pre><h3 id="OdsIO.jl:-ods-{Matrix,-DataFrame}"><a class="docs-heading-anchor" href="#OdsIO.jl:-ods-{Matrix,-DataFrame}">OdsIO.jl: ods -&gt; {Matrix, DataFrame}</a><a id="OdsIO.jl:-ods-{Matrix,-DataFrame}-1"></a><a class="docs-heading-anchor-permalink" href="#OdsIO.jl:-ods-{Matrix,-DataFrame}" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using OdsIO</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ods_read(&quot;data.ods&quot;;sheetName=&quot;Sheet1&quot;,retType=&quot;DataFrame&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; ods_read(&quot;data.ods&quot;;sheetName=&quot;Sheet1&quot;,retType=&quot;Matrix&quot;,range=[(2,3),(9,4)]) # [(tlr,tlc),(brr,brc)]</code><code class="nohighlight hljs ansi" style="display:block;">8×2 Matrix{Any}:
 11.354    3381
 15.288    2254.28
  8.36925  1058.71
 28.163    3184.67
 11.419    3663
 17.253    3055.83
  9.56613  1424.4
 27.98     3653.91</code></pre><h3 id="HTTP.jl:-from-internet"><a class="docs-heading-anchor" href="#HTTP.jl:-from-internet">HTTP.jl: from internet</a><a id="HTTP.jl:-from-internet-1"></a><a class="docs-heading-anchor-permalink" href="#HTTP.jl:-from-internet" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; import HTTP</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Pipe, ZipFile, Tar</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; urlData = &quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/raw/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/data.csv&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/raw/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/data.csv&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; urlDataZ = &quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/raw/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/data.zip&quot;</code><code class="nohighlight hljs ansi" style="display:block;">&quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/raw/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/data.zip&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = @pipe HTTP.get(urlData).body        |&gt;
                    replace!(_, UInt8(&#39;;&#39;) =&gt; UInt8(&#39; &#39;)) |&gt;  # if we need to do modifications to the file before importing
                    CSV.File(_, delim=&#39; &#39;)                |&gt;
                    DataFrame;</code><code class="nohighlight hljs ansi" style="display:block;"></code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><h3 id="ZipFile.jl-:-from-a-single-zipped-csv-file.."><a class="docs-heading-anchor" href="#ZipFile.jl-:-from-a-single-zipped-csv-file..">ZipFile.jl : from a single zipped csv file..</a><a id="ZipFile.jl-:-from-a-single-zipped-csv-file..-1"></a><a class="docs-heading-anchor-permalink" href="#ZipFile.jl-:-from-a-single-zipped-csv-file.." title="Permalink"></a></h3><p>...on disk...</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = @pipe ZipFile.Reader(&quot;data.zip&quot;).files[1] |&gt;
                    CSV.File(read(_), delim=&#39;;&#39;) |&gt;
                    DataFrame</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String7  Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code></pre><p>...or on internet:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = @pipe HTTP.get(urlDataZ).body       |&gt;
                    IOBuffer(_)                      |&gt;
                    ZipFile.Reader(_).files[1]    |&gt;
                    CSV.File(read(_), delim=&#39;;&#39;)  |&gt;
                    DataFrame</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String7  Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code></pre><h3 id="DataFrame-constructor"><a class="docs-heading-anchor" href="#DataFrame-constructor">DataFrame constructor</a><a id="DataFrame-constructor-1"></a><a class="docs-heading-anchor-permalink" href="#DataFrame-constructor" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; # named tuple of (colName,colData)..
       data = DataFrame(
           country = [&quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;, &quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;],
           year    = [2000,2000,2000,2000,2020,2020,2020,2020],
           forarea = [11.354, 15.288, 8.36925, 28.163, 11.419, 17.253, 9.56613, 27.98],
           forvol  = [3381, 2254.28, 1058.71, 3184.67, 3663, 3055.83, 1424.4, 3653.91]
       )</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ country  year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code></pre><h3 id="Matrix-DataFrame"><a class="docs-heading-anchor" href="#Matrix-DataFrame">Matrix -&gt; DataFrame</a><a id="Matrix-DataFrame-1"></a><a class="docs-heading-anchor-permalink" href="#Matrix-DataFrame" title="Permalink"></a></h3><p>Headers and data separated:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; M = [&quot;Germany&quot;	2000	11.354	3381
            &quot;France&quot;	2000	15.288	2254.28
            &quot;Italy&quot;	2000	8.36925	1058.71
            &quot;Sweden&quot;	2000	28.163	3184.67
            &quot;Germany&quot;	2020	11.419	3663
            &quot;France&quot;	2020	17.253	3055.83
            &quot;Italy&quot;	2020	9.56613	1424.4
            &quot;Sweden&quot;	2020	27.98	3653.91]</code><code class="nohighlight hljs ansi" style="display:block;">8×4 Matrix{Any}:
 &quot;Germany&quot;  2000  11.354    3381
 &quot;France&quot;   2000  15.288    2254.28
 &quot;Italy&quot;    2000   8.36925  1058.71
 &quot;Sweden&quot;   2000  28.163    3184.67
 &quot;Germany&quot;  2020  11.419    3663
 &quot;France&quot;   2020  17.253    3055.83
 &quot;Italy&quot;    2020   9.56613  1424.4
 &quot;Sweden&quot;   2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; headers = [&quot;Country&quot;, &quot;Year&quot;, &quot;forarea&quot;, &quot;forvol&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">4-element Vector{String}:
 &quot;Country&quot;
 &quot;Year&quot;
 &quot;forarea&quot;
 &quot;forvol&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # array of colData arrays, array of headers
       data = DataFrame([[M[:,i]...] for i in 1:size(M,2)], Symbol.(headers))</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code></pre><p>Headers on the first row of the matrix:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; M = [&quot;Country&quot;	&quot;Year&quot;	&quot;forarea&quot; &quot;forvol&quot;
            &quot;Germany&quot;	2000	11.354	  3381
            &quot;France&quot;	2000	15.288	  2254.28
            &quot;Italy&quot;	2000	8.36925	  1058.71
            &quot;Sweden&quot;	2000	28.163	  3184.67
            &quot;Germany&quot;	2020	11.419	  3663
            &quot;France&quot;	2020	17.253	  3055.83
            &quot;Italy&quot;	2020	9.56613	  1424.4
            &quot;Sweden&quot;	2020	27.98	  3653.91]</code><code class="nohighlight hljs ansi" style="display:block;">9×4 Matrix{Any}:
 &quot;Country&quot;      &quot;Year&quot;    &quot;forarea&quot;      &quot;forvol&quot;
 &quot;Germany&quot;  2000        11.354       3381
 &quot;France&quot;   2000        15.288       2254.28
 &quot;Italy&quot;    2000         8.36925     1058.71
 &quot;Sweden&quot;   2000        28.163       3184.67
 &quot;Germany&quot;  2020        11.419       3663
 &quot;France&quot;   2020        17.253       3055.83
 &quot;Italy&quot;    2020         9.56613     1424.4
 &quot;Sweden&quot;   2020        27.98        3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data = DataFrame([[M[2:end,i]...] for i in 1:size(M,2)], Symbol.(M[1,:])) # note the autorecognision of col types</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code></pre><h2 id="Getting-insights-on-the-data"><a class="docs-heading-anchor" href="#Getting-insights-on-the-data">Getting insights on the data</a><a id="Getting-insights-on-the-data-1"></a><a class="docs-heading-anchor-permalink" href="#Getting-insights-on-the-data" title="Permalink"></a></h2><p>In VSCode, we can also use the workpanel for a nice sortable tabular view of a df</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; show(data,allrows=true,allcols=true)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; first(data,6)</code><code class="nohighlight hljs ansi" style="display:block;">6×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; last(data, 6)</code><code class="nohighlight hljs ansi" style="display:block;">6×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Italy     2000   8.36925  1058.71
   2 │ Sweden    2000  28.163    3184.67
   3 │ Germany   2020  11.419    3663.0
   4 │ France    2020  17.253    3055.83
   5 │ Italy     2020   9.56613  1424.4
   6 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; describe(data)</code><code class="nohighlight hljs ansi" style="display:block;">4×7 DataFrame
 Row │ variable  mean     min      median   max     nmissing  eltype
     │ Symbol    Union…   Any      Union…   Any     Int64     DataType
─────┼─────────────────────────────────────────────────────────────────
   1 │ Country            France            Sweden         0  String
   2 │ Year      2010.0   2000     2010.0   2020           0  Int64
   3 │ forarea   16.174   8.36925  13.3535  28.163         0  Float64
   4 │ forvol    2709.47  1058.71  3120.25  3663.0         0  Float64</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nR,nC = size(data)</code><code class="nohighlight hljs ansi" style="display:block;">(8, 4)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; names(data)</code><code class="nohighlight hljs ansi" style="display:block;">4-element Vector{String}:
 &quot;Country&quot;
 &quot;Year&quot;
 &quot;forarea&quot;
 &quot;forvol&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for r in eachrow(data)
           println(r) # note is it a &quot;DataFrameRow&quot;
       end</code><code class="nohighlight hljs ansi" style="display:block;">DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   1 │ Germany   2000   11.354   3381.0
DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   2 │ France    2000   15.288  2254.28
DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   3 │ Italy     2000  8.36925  1058.71
DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   4 │ Sweden    2000   28.163  3184.67
DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   5 │ Germany   2020   11.419   3663.0
DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   6 │ France    2020   17.253  3055.83
DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   7 │ Italy     2020  9.56613   1424.4
DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   8 │ Sweden    2020    27.98  3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; for c in eachcol(data)
           println(c) # an array
           println(nonmissingtype(eltype(c)))
       end</code><code class="nohighlight hljs ansi" style="display:block;">[&quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;, &quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;]
String
[2000, 2000, 2000, 2000, 2020, 2020, 2020, 2020]
Int64
[11.354, 15.288, 8.36925, 28.163, 11.419, 17.253, 9.56613, 27.98]
Float64
[3381.0, 2254.28, 1058.71, 3184.67, 3663.0, 3055.83, 1424.4, 3653.91]
Float64</code></pre><h2 id="Selection-and-querying-data"><a class="docs-heading-anchor" href="#Selection-and-querying-data">Selection and querying data</a><a id="Selection-and-querying-data-1"></a><a class="docs-heading-anchor-permalink" href="#Selection-and-querying-data" title="Permalink"></a></h2><h3 id="Column(s)-selection"><a class="docs-heading-anchor" href="#Column(s)-selection">Column(s) selection</a><a id="Column(s)-selection-1"></a><a class="docs-heading-anchor-permalink" href="#Column(s)-selection" title="Permalink"></a></h3><p>In general we can select: (a) by name (strings or symbols) or by position; (b) a single or a vector of columns, (c) copying or making a view (a reference without copying) of the underlying data</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[:,[&quot;Country&quot;,&quot;Year&quot;]] # copy, using strings</code><code class="nohighlight hljs ansi" style="display:block;">8×2 DataFrame
 Row │ Country  Year
     │ String   Int64
─────┼────────────────
   1 │ Germany   2000
   2 │ France    2000
   3 │ Italy     2000
   4 │ Sweden    2000
   5 │ Germany   2020
   6 │ France    2020
   7 │ Italy     2020
   8 │ Sweden    2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[!,[:Country,:Year]]   # view, using symbols</code><code class="nohighlight hljs ansi" style="display:block;">8×2 DataFrame
 Row │ Country  Year
     │ String   Int64
─────┼────────────────
   1 │ Germany   2000
   2 │ France    2000
   3 │ Italy     2000
   4 │ Sweden    2000
   5 │ Germany   2020
   6 │ France    2020
   7 │ Italy     2020
   8 │ Sweden    2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data.Year                  # equiv. to `data[!,Year]`</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Int64}:
 2000
 2000
 2000
 2000
 2020
 2020
 2020
 2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[:,1]                  # also `data[!,1]`</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{String}:
 &quot;Germany&quot;
 &quot;France&quot;
 &quot;Italy&quot;
 &quot;Sweden&quot;
 &quot;Germany&quot;
 &quot;France&quot;
 &quot;Italy&quot;
 &quot;Sweden&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[:,Not([&quot;Year&quot;])]</code><code class="nohighlight hljs ansi" style="display:block;">8×3 DataFrame
 Row │ Country  forarea   forvol
     │ String   Float64   Float64
─────┼────────────────────────────
   1 │ Germany  11.354    3381.0
   2 │ France   15.288    2254.28
   3 │ Italy     8.36925  1058.71
   4 │ Sweden   28.163    3184.67
   5 │ Germany  11.419    3663.0
   6 │ France   17.253    3055.83
   7 │ Italy     9.56613  1424.4
   8 │ Sweden   27.98     3653.91</code></pre><h3 id="Row(s)-selection"><a class="docs-heading-anchor" href="#Row(s)-selection">Row(s) selection</a><a id="Row(s)-selection-1"></a><a class="docs-heading-anchor-permalink" href="#Row(s)-selection" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[1,:]    # DataFrameRow</code><code class="nohighlight hljs ansi" style="display:block;">DataFrameRow
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   1 │ Germany   2000   11.354   3381.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[1:3,:]  # DataFrame</code><code class="nohighlight hljs ansi" style="display:block;">3×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71</code></pre><p>Note rows have no title names as colums do.</p><h3 id="Cell(s)-selection"><a class="docs-heading-anchor" href="#Cell(s)-selection">Cell(s) selection</a><a id="Cell(s)-selection-1"></a><a class="docs-heading-anchor-permalink" href="#Cell(s)-selection" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[2,[2,4]]</code><code class="nohighlight hljs ansi" style="display:block;">DataFrameRow
 Row │ Year   forvol
     │ Int64  Float64
─────┼────────────────
   2 │  2000  2254.28</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[2,&quot;forarea&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">15.288</code></pre><p>Note that the returned selection is:</p><ul><li>an <code>Array{T,1}</code> if it is a single column;</li><li>a <code>DataFrameRow</code> (similar in behaviour to a <code>DataFrame</code>) if a single row;</li><li><code>T</code> if a single cell;</li><li>an other <code>DataFrame</code> otherwise.</li></ul><h3 id="Boolean-selection"><a class="docs-heading-anchor" href="#Boolean-selection">Boolean selection</a><a id="Boolean-selection-1"></a><a class="docs-heading-anchor-permalink" href="#Boolean-selection" title="Permalink"></a></h3><p>Both rows and column of a DataFrame (but also of an Matrix) can be selected by passing an array of booleans as column or row mask (and, only for Matrices, also a matrix of booleans)</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; mask = [false, false, false, false, true, true, true, true]</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Bool}:
 0
 0
 0
 0
 1
 1
 1
 1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[mask,:]</code><code class="nohighlight hljs ansi" style="display:block;">4×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2020  11.419    3663.0
   2 │ France    2020  17.253    3055.83
   3 │ Italy     2020   9.56613  1424.4
   4 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mask = fill(false,nR,nC)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 Matrix{Bool}:
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0
 0  0  0  0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mask[2:end,2:3] .= true</code><code class="nohighlight hljs ansi" style="display:block;">7×2 view(::Matrix{Bool}, 2:8, 2:3) with eltype Bool:
 1  1
 1  1
 1  1
 1  1
 1  1
 1  1
 1  1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; mask</code><code class="nohighlight hljs ansi" style="display:block;">8×4 Matrix{Bool}:
 0  0  0  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0
 0  1  1  0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # data[mask] # error !
       Matrix(data)[mask]</code><code class="nohighlight hljs ansi" style="display:block;">14-element Vector{Any}:
 2000
 2000
 2000
 2020
 2020
 2020
 2020
   15.288
    8.36925
   28.163
   11.419
   17.253
    9.56613
   27.98</code></pre><p>Boolean selection can be used to filter on conditions, e.g.:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[data.Year .&gt;= 2020,:]</code><code class="nohighlight hljs ansi" style="display:block;">4×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2020  11.419    3663.0
   2 │ France    2020  17.253    3055.83
   3 │ Italy     2020   9.56613  1424.4
   4 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; data[[i in [&quot;France&quot;, &quot;Italy&quot;] for i in data.Country] .&amp;&amp; (data.Year .== 2000),:] # note the parhenthesis</code><code class="nohighlight hljs ansi" style="display:block;">2×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ France    2000  15.288    2254.28
   2 │ Italy     2000   8.36925  1058.71</code></pre><h3 id="Filtering-using-the-@subset-macro-from-the-DataFramesMacro-package"><a class="docs-heading-anchor" href="#Filtering-using-the-@subset-macro-from-the-DataFramesMacro-package">Filtering using the @subset macro from the <code>DataFramesMacro</code> package</a><a id="Filtering-using-the-@subset-macro-from-the-DataFramesMacro-package-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-using-the-@subset-macro-from-the-DataFramesMacro-package" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFramesMeta</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @subset(data, :Year .&gt; 2010 )</code><code class="nohighlight hljs ansi" style="display:block;">4×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2020  11.419    3663.0
   2 │ France    2020  17.253    3055.83
   3 │ Italy     2020   9.56613  1424.4
   4 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; colToFilter = :Country</code><code class="nohighlight hljs ansi" style="display:block;">:Country</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; @subset(data, :Year .&gt; 2010, cols(colToFilter) .== &quot;France&quot; ) # Conditions are &quot;end&quot; by default. If the column name is embedded in a varaible we eed to use `cols(varname)`</code><code class="nohighlight hljs ansi" style="display:block;">1×4 DataFrame
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   1 │ France    2020   17.253  3055.83</code></pre><h3 id="Filtering-using-the-Query-package"><a class="docs-heading-anchor" href="#Filtering-using-the-Query-package">Filtering using the <code>Query</code> package</a><a id="Filtering-using-the-Query-package-1"></a><a class="docs-heading-anchor-permalink" href="#Filtering-using-the-Query-package" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Query</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dfOut = @from i in data begin # `i` is a single row
           @where i.Country == &quot;France&quot; .&amp;&amp; i.Year &gt;= 2000
           # Select a group of columns, eventually changing their name:
           @select {i.Year, FranceForArea=i.forarea} # or just `i` for the whole row
           @collect DataFrame
       end</code><code class="nohighlight hljs ansi" style="display:block;">2×2 DataFrame
 Row │ Year   FranceForArea
     │ Int64  Float64
─────┼──────────────────────
   1 │  2000         15.288
   2 │  2020         17.253</code></pre><p>long but flexible</p><h3 id="Managing-missing-values"><a class="docs-heading-anchor" href="#Managing-missing-values">Managing missing values</a><a id="Managing-missing-values-1"></a><a class="docs-heading-anchor-permalink" href="#Managing-missing-values" title="Permalink"></a></h3><div class="admonition is-success"><header class="admonition-header">Tip</header><div class="admonition-body"><p>See also the section <a href="02_-_JULIA2_-_Scientific_programming_with_Julia/@ref"><code>Missingness implementations</code></a> for a general discussion on missing values</p></div></div><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; df = copy(data)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; # df[3,&quot;forarea&quot;]  = missing # Error, type is Flat64, not Union{Float64,Missing}
       df.forarea = allowmissing(df.forarea) # also disallowmissing</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Union{Missing, Float64}}:
 11.354
 15.288
  8.36925
 28.163
 11.419
 17.253
  9.56613
 27.98</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; allowmissing!(df)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year    forarea   forvol
     │ String?  Int64?  Float64?  Float64?
─────┼─────────────────────────────────────
   1 │ Germany    2000  11.354     3381.0
   2 │ France     2000  15.288     2254.28
   3 │ Italy      2000   8.36925   1058.71
   4 │ Sweden     2000  28.163     3184.67
   5 │ Germany    2020  11.419     3663.0
   6 │ France     2020  17.253     3055.83
   7 │ Italy      2020   9.56613   1424.4
   8 │ Sweden     2020  27.98      3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df[3,&quot;forarea&quot;]  = missing</code><code class="nohighlight hljs ansi" style="display:block;">missing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df[6,&quot;forarea&quot;]  = missing</code><code class="nohighlight hljs ansi" style="display:block;">missing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df[6,&quot;Country&quot;]  = missing</code><code class="nohighlight hljs ansi" style="display:block;">missing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nMissings        = length(findall(x -&gt; ismissing(x), df.forarea)) # Count `missing` values in a column.</code><code class="nohighlight hljs ansi" style="display:block;">2</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dropmissing(df)</code><code class="nohighlight hljs ansi" style="display:block;">6×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Sweden    2000  28.163    3184.67
   4 │ Germany   2020  11.419    3663.0
   5 │ Italy     2020   9.56613  1424.4
   6 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dropmissing(df[:,[&quot;forarea&quot;,&quot;forvol&quot;]])</code><code class="nohighlight hljs ansi" style="display:block;">6×2 DataFrame
 Row │ forarea   forvol
     │ Float64   Float64
─────┼───────────────────
   1 │ 11.354    3381.0
   2 │ 15.288    2254.28
   3 │ 28.163    3184.67
   4 │ 11.419    3663.0
   5 │  9.56613  1424.4
   6 │ 27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; collect(skipmissing(df.forarea))</code><code class="nohighlight hljs ansi" style="display:block;">6-element Vector{Float64}:
 11.354
 15.288
 28.163
 11.419
  9.56613
 27.98</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; completecases(df)</code><code class="nohighlight hljs ansi" style="display:block;">8-element BitVector:
 1
 1
 0
 1
 1
 0
 1
 1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; completecases(df[!,[&quot;forarea&quot;,&quot;forvol&quot;]])</code><code class="nohighlight hljs ansi" style="display:block;">8-element BitVector:
 1
 1
 0
 1
 1
 0
 1
 1</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; [df[ismissing.(df[!,col]), col] .= 0 for col in names(df) if nonmissingtype(eltype(df[!,col])) &lt;: Number] # Replace `missing` with `0` values in all numeric columns, like `Float64` and `Int64`;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; [df[ismissing.(df[!,col]), col] .= &quot;&quot; for col in names(df) if nonmissingtype(eltype(df[!,col])) &lt;: AbstractString] # Replace `missing` with `&quot;&quot;` values in all string columns;</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year    forarea   forvol
     │ String?  Int64?  Float64?  Float64?
─────┼─────────────────────────────────────
   1 │ Germany    2000  11.354     3381.0
   2 │ France     2000  15.288     2254.28
   3 │ Italy      2000   0.0       1058.71
   4 │ Sweden     2000  28.163     3184.67
   5 │ Germany    2020  11.419     3663.0
   6 │            2020   0.0       3055.83
   7 │ Italy      2020   9.56613   1424.4
   8 │ Sweden     2020  27.98      3653.91</code></pre><h2 id="Editing-data"><a class="docs-heading-anchor" href="#Editing-data">Editing data</a><a id="Editing-data-1"></a><a class="docs-heading-anchor-permalink" href="#Editing-data" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; df = copy(data)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df[1,&quot;forarea&quot;] = 11.3</code><code class="nohighlight hljs ansi" style="display:block;">11.3</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df[[2,4],&quot;forarea&quot;] .= 10</code><code class="nohighlight hljs ansi" style="display:block;">2-element view(::Vector{Float64}, [2, 4]) with eltype Float64:
 10.0
 10.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.3      3381.0
   2 │ France    2000  10.0      2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  10.0      3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; push!(df,[&quot;UK&quot;,2020,5.0,800.0]) # add row</code><code class="nohighlight hljs ansi" style="display:block;">9×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.3      3381.0
   2 │ France    2000  10.0      2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  10.0      3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91
   9 │ UK        2020   5.0       800.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sort!(df,[&quot;Country&quot;,&quot;Year&quot;], rev=false)</code><code class="nohighlight hljs ansi" style="display:block;">9×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ France    2000  10.0      2254.28
   2 │ France    2020  17.253    3055.83
   3 │ Germany   2000  11.3      3381.0
   4 │ Germany   2020  11.419    3663.0
   5 │ Italy     2000   8.36925  1058.71
   6 │ Italy     2020   9.56613  1424.4
   7 │ Sweden    2000  10.0      3184.67
   8 │ Sweden    2020  27.98     3653.91
   9 │ UK        2020   5.0       800.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df2 = similar(df) # rubish inside</code><code class="nohighlight hljs ansi" style="display:block;">9×4 DataFrame
 Row │ Country  Year             forarea         forvol
     │ String   Int64            Float64         Float64
─────┼──────────────────────────────────────────────────────────
   1 │ #undef   140105266725440    6.92212e-310    6.92206e-310
   2 │ #undef   140105127683536    6.92211e-310    6.92211e-310
   3 │ #undef   140105266725600    6.92212e-310    6.92206e-310
   4 │ #undef   140107907629600    6.92225e-310    6.92225e-310
   5 │ #undef   140107953731264    6.92225e-310    6.92225e-310
   6 │ #undef   140108131065864    6.92226e-310    6.92226e-310
   7 │ #undef                 1    5.0e-324        5.0e-324
   8 │ #undef                -1  NaN             NaN
   9 │ #undef   139637993505025    6.89903e-310    6.89903e-310</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df = similar(df,0) # empty a dataframe. The second parameter is the number of rows desired</code><code class="nohighlight hljs ansi" style="display:block;">0×4 DataFrame</code></pre><h2 id="Work-on-dataframe-structure"><a class="docs-heading-anchor" href="#Work-on-dataframe-structure">Work on dataframe structure</a><a id="Work-on-dataframe-structure-1"></a><a class="docs-heading-anchor-permalink" href="#Work-on-dataframe-structure" title="Permalink"></a></h2><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; df       = copy(data)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df.foo   = [1,2,3,4,5,6,7,8] # existing or new column</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Int64}:
 1
 2
 3
 4
 5
 6
 7
 8</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df.volHa = data.forvol ./ data.forarea</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Float64}:
 297.78051787916155
 147.45421245421247
 126.49998506437257
 113.07992756453503
 320.78115421665643
 177.1187619544427
 148.9003390085646
 130.59006433166547</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df.goo   = Array{Union{Missing,Float64},1}(missing,size(data,1))</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Union{Missing, Float64}}:
 missing
 missing
 missing
 missing
 missing
 missing
 missing
 missing</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; select!(df,Not([&quot;foo&quot;,&quot;volHa&quot;,&quot;goo&quot;])) # remove  cols by name</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rename!(df, [&quot;Country2&quot;, &quot;Year2&quot;, &quot;forarea2&quot;, &quot;forvol2&quot;])</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country2  Year2  forarea2  forvol2
     │ String    Int64  Float64   Float64
─────┼────────────────────────────────────
   1 │ Germany    2000  11.354    3381.0
   2 │ France     2000  15.288    2254.28
   3 │ Italy      2000   8.36925  1058.71
   4 │ Sweden     2000  28.163    3184.67
   5 │ Germany    2020  11.419    3663.0
   6 │ France     2020  17.253    3055.83
   7 │ Italy      2020   9.56613  1424.4
   8 │ Sweden     2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rename!(df, Dict(&quot;Country2&quot; =&gt; &quot;Country&quot;))</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year2  forarea2  forvol2
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df       = df[:,[&quot;Year2&quot;, &quot;Country&quot;,&quot;forarea2&quot;,&quot;forvol2&quot;] ] #  change column order</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Year2  Country  forarea2  forvol2
     │ Int64  String   Float64   Float64
─────┼───────────────────────────────────
   1 │  2000  Germany  11.354    3381.0
   2 │  2000  France   15.288    2254.28
   3 │  2000  Italy     8.36925  1058.71
   4 │  2000  Sweden   28.163    3184.67
   5 │  2020  Germany  11.419    3663.0
   6 │  2020  France   17.253    3055.83
   7 │  2020  Italy     9.56613  1424.4
   8 │  2020  Sweden   27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; insertcols!(df, 2, :foo =&gt; [1,2,3,4,5,6,7,8] ) # insert a column at position 2</code><code class="nohighlight hljs ansi" style="display:block;">8×5 DataFrame
 Row │ Year2  foo    Country  forarea2  forvol2
     │ Int64  Int64  String   Float64   Float64
─────┼──────────────────────────────────────────
   1 │  2000      1  Germany  11.354    3381.0
   2 │  2000      2  France   15.288    2254.28
   3 │  2000      3  Italy     8.36925  1058.71
   4 │  2000      4  Sweden   28.163    3184.67
   5 │  2020      5  Germany  11.419    3663.0
   6 │  2020      6  France   17.253    3055.83
   7 │  2020      7  Italy     9.56613  1424.4
   8 │  2020      8  Sweden   27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df.namedYear = map(string,df.Year2)</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{String}:
 &quot;2000&quot;
 &quot;2000&quot;
 &quot;2000&quot;
 &quot;2000&quot;
 &quot;2020&quot;
 &quot;2020&quot;
 &quot;2020&quot;
 &quot;2020&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; stringToInt(str) = try parse(Int64, str) catch; return(missing) end; df.Year3 = map(stringToInt, df.namedYear)</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Int64}:
 2000
 2000
 2000
 2000
 2020
 2020
 2020
 2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df2 = hcat(df,data,makeunique=true)</code><code class="nohighlight hljs ansi" style="display:block;">8×11 DataFrame
 Row │ Year2  foo    Country  forarea2  forvol2  namedYear  Year3  Country_1   ⋯
     │ Int64  Int64  String   Float64   Float64  String     Int64  String      ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │  2000      1  Germany  11.354    3381.0   2000        2000  Germany     ⋯
   2 │  2000      2  France   15.288    2254.28  2000        2000  France
   3 │  2000      3  Italy     8.36925  1058.71  2000        2000  Italy
   4 │  2000      4  Sweden   28.163    3184.67  2000        2000  Sweden
   5 │  2020      5  Germany  11.419    3663.0   2020        2020  Germany     ⋯
   6 │  2020      6  France   17.253    3055.83  2020        2020  France
   7 │  2020      7  Italy     9.56613  1424.4   2020        2020  Italy
   8 │  2020      8  Sweden   27.98     3653.91  2020        2020  Sweden
                                                               3 columns omitted</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df3 = copy(data)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df4 = vcat(data,df3)</code><code class="nohighlight hljs ansi" style="display:block;">16×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91
   9 │ Germany   2000  11.354    3381.0
  10 │ France    2000  15.288    2254.28
  11 │ Italy     2000   8.36925  1058.71
  12 │ Sweden    2000  28.163    3184.67
  13 │ Germany   2020  11.419    3663.0
  14 │ France    2020  17.253    3055.83
  15 │ Italy     2020   9.56613  1424.4
  16 │ Sweden    2020  27.98     3653.91</code></pre><h3 id="Categorical-data"><a class="docs-heading-anchor" href="#Categorical-data">Categorical data</a><a id="Categorical-data-1"></a><a class="docs-heading-anchor-permalink" href="#Categorical-data" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using CategoricalArrays # You may want to consider also PooledArrays</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df.Year2 = categorical(df.Year2)</code><code class="nohighlight hljs ansi" style="display:block;">8-element CategoricalArrays.CategoricalArray{Int64,1,UInt32}:
 2000
 2000
 2000
 2000
 2020
 2020
 2020
 2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; transform!(df, names(df, AbstractString) .=&gt; categorical, renamecols=false) # transform to categorical all string columns</code><code class="nohighlight hljs ansi" style="display:block;">8×7 DataFrame
 Row │ Year2  foo    Country  forarea2  forvol2  namedYear  Year3
     │ Cat…   Int64  Cat…     Float64   Float64  Cat…       Int64
─────┼────────────────────────────────────────────────────────────
   1 │ 2000       1  Germany  11.354    3381.0   2000        2000
   2 │ 2000       2  France   15.288    2254.28  2000        2000
   3 │ 2000       3  Italy     8.36925  1058.71  2000        2000
   4 │ 2000       4  Sweden   28.163    3184.67  2000        2000
   5 │ 2020       5  Germany  11.419    3663.0   2020        2020
   6 │ 2020       6  France   17.253    3055.83  2020        2020
   7 │ 2020       7  Italy     9.56613  1424.4   2020        2020
   8 │ 2020       8  Sweden   27.98     3653.91  2020        2020</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Attention that while the memory to store the data decreases, and grouping is way more efficient, filtering with categorical values is not necessarily quicker (indeed it can be a bit slower)</p></div></div><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; levels(df.Year2)</code><code class="nohighlight hljs ansi" style="display:block;">2-element Vector{Int64}:
 2000
 2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; levels!(df.Country,[&quot;Sweden&quot;,&quot;Germany&quot;,&quot;France&quot;,&quot;Italy&quot;]) # Let you define a personalised order, useful for ordered data</code><code class="nohighlight hljs ansi" style="display:block;">8-element CategoricalArrays.CategoricalArray{String,1,UInt32}:
 &quot;Germany&quot;
 &quot;France&quot;
 &quot;Italy&quot;
 &quot;Sweden&quot;
 &quot;Germany&quot;
 &quot;France&quot;
 &quot;Italy&quot;
 &quot;Sweden&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sort(df.Country)</code><code class="nohighlight hljs ansi" style="display:block;">8-element CategoricalArrays.CategoricalArray{String,1,UInt32}:
 &quot;Sweden&quot;
 &quot;Sweden&quot;
 &quot;Germany&quot;
 &quot;Germany&quot;
 &quot;France&quot;
 &quot;France&quot;
 &quot;Italy&quot;
 &quot;Italy&quot;</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; sort!(df,&quot;Country&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">8×7 DataFrame
 Row │ Year2  foo    Country  forarea2  forvol2  namedYear  Year3
     │ Cat…   Int64  Cat…     Float64   Float64  Cat…       Int64
─────┼────────────────────────────────────────────────────────────
   1 │ 2000       4  Sweden   28.163    3184.67  2000        2000
   2 │ 2020       8  Sweden   27.98     3653.91  2020        2020
   3 │ 2000       1  Germany  11.354    3381.0   2000        2000
   4 │ 2020       5  Germany  11.419    3663.0   2020        2020
   5 │ 2000       2  France   15.288    2254.28  2000        2000
   6 │ 2020       6  France   17.253    3055.83  2020        2020
   7 │ 2000       3  Italy     8.36925  1058.71  2000        2000
   8 │ 2020       7  Italy     9.56613  1424.4   2020        2020</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; df.Years2 = unwrap.(df.Year2) # convert a categorical array into a normal one.</code><code class="nohighlight hljs ansi" style="display:block;">8-element Vector{Int64}:
 2000
 2020
 2000
 2020
 2000
 2020
 2000
 2020</code></pre><h3 id="Joining-dataframes"><a class="docs-heading-anchor" href="#Joining-dataframes">Joining dataframes</a><a id="Joining-dataframes-1"></a><a class="docs-heading-anchor-permalink" href="#Joining-dataframes" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; df1,df2 = copy(data),copy(data)</code><code class="nohighlight hljs ansi" style="display:block;">(8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91, 8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; push!(df1,[&quot;US&quot;,2020,5.0,1000.0])</code><code class="nohighlight hljs ansi" style="display:block;">9×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91
   9 │ US        2020   5.0      1000.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; push!(df2,[&quot;China&quot;,2020,50.0,1000.0])</code><code class="nohighlight hljs ansi" style="display:block;">9×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91
   9 │ China     2020  50.0      1000.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rename!(df2,&quot;Year&quot;=&gt;&quot;year&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">9×4 DataFrame
 Row │ Country  year   forarea   forvol
     │ String   Int64  Float64   Float64
─────┼───────────────────────────────────
   1 │ Germany   2000  11.354    3381.0
   2 │ France    2000  15.288    2254.28
   3 │ Italy     2000   8.36925  1058.71
   4 │ Sweden    2000  28.163    3184.67
   5 │ Germany   2020  11.419    3663.0
   6 │ France    2020  17.253    3055.83
   7 │ Italy     2020   9.56613  1424.4
   8 │ Sweden    2020  27.98     3653.91
   9 │ China     2020  50.0      1000.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; innerjoin(df1,df2,on=[&quot;Country&quot;,&quot;Year&quot;=&gt;&quot;year&quot;],makeunique=true) # common records only</code><code class="nohighlight hljs ansi" style="display:block;">8×6 DataFrame
 Row │ Country  Year   forarea   forvol   forarea_1  forvol_1
     │ String   Int64  Float64   Float64  Float64    Float64
─────┼────────────────────────────────────────────────────────
   1 │ Germany   2000  11.354    3381.0    11.354     3381.0
   2 │ France    2000  15.288    2254.28   15.288     2254.28
   3 │ Italy     2000   8.36925  1058.71    8.36925   1058.71
   4 │ Sweden    2000  28.163    3184.67   28.163     3184.67
   5 │ Germany   2020  11.419    3663.0    11.419     3663.0
   6 │ France    2020  17.253    3055.83   17.253     3055.83
   7 │ Italy     2020   9.56613  1424.4     9.56613   1424.4
   8 │ Sweden    2020  27.98     3653.91   27.98      3653.91</code></pre><p>Also available: <code>leftjoin</code> (all records on left df), <code>rightjoin</code> (all on right df), <code>outerjoin</code>(all records returned), <code>semijoin</code> (like inner join by only with columns from the right df), <code>antijoin</code> (left not on right df) and <code>crossjoin</code> (like the cartesian product, each on the right by each on the left)</p><h2 id="Pivoting-data"><a class="docs-heading-anchor" href="#Pivoting-data">Pivoting data</a><a id="Pivoting-data-1"></a><a class="docs-heading-anchor-permalink" href="#Pivoting-data" title="Permalink"></a></h2><p><em>long</em> and <em>wide</em> are two kind of layout for equivalent representation of tabled data. In a <em>long</em> layout we have each row being an observation of a single variable, and each record is represented as dim1, dim2, ..., value. As the name implies, &quot;long&quot; layouts tend to be relativelly long and hard to analyse by an human, but are very easity to handle. At the opposite, A <em>wide</em> layout represents multiple observations on the same row, eventually using multiple horizontal axis as in the next figure (but Julia dataframes handle only a single horizzontal axis):</p><table><tr><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right"></th></tr><tr><td style="text-align: right"></td><td style="text-align: right">Forest Area</td><td style="text-align: right"></td><td style="text-align: right">Forest Volumes</td><td style="text-align: right"></td></tr><tr><td style="text-align: right"></td><td style="text-align: right">2000</td><td style="text-align: right">2020</td><td style="text-align: right">2000</td><td style="text-align: right">2020</td></tr><tr><td style="text-align: right">Germany</td><td style="text-align: right">11.35</td><td style="text-align: right">11.42</td><td style="text-align: right">3381</td><td style="text-align: right">3663</td></tr><tr><td style="text-align: right">France</td><td style="text-align: right">15.29</td><td style="text-align: right">17.25</td><td style="text-align: right">2254</td><td style="text-align: right">3056</td></tr></table><p>_wide layout is easier to visually analise for a human mind but much more hard to analyse in a sistermatic way. We will learn now how to move from one type of layout to the other.</p><h3 id="Stacking-columns:-from-*wide*-to-*long*"><a class="docs-heading-anchor" href="#Stacking-columns:-from-*wide*-to-*long*">Stacking columns: from <em>wide</em> to <em>long</em></a><a id="Stacking-columns:-from-*wide*-to-*long*-1"></a><a class="docs-heading-anchor-permalink" href="#Stacking-columns:-from-*wide*-to-*long*" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; longDf  = stack(data,[&quot;forarea&quot;,&quot;forvol&quot;])    # we specify the variable to stack (the &quot;measured&quot; variables)</code><code class="nohighlight hljs ansi" style="display:block;">16×4 DataFrame
 Row │ Country  Year   variable  value
     │ String   Int64  String    Float64
─────┼──────────────────────────────────────
   1 │ Germany   2000  forarea     11.354
   2 │ France    2000  forarea     15.288
   3 │ Italy     2000  forarea      8.36925
   4 │ Sweden    2000  forarea     28.163
   5 │ Germany   2020  forarea     11.419
   6 │ France    2020  forarea     17.253
   7 │ Italy     2020  forarea      9.56613
   8 │ Sweden    2020  forarea     27.98
   9 │ Germany   2000  forvol    3381.0
  10 │ France    2000  forvol    2254.28
  11 │ Italy     2000  forvol    1058.71
  12 │ Sweden    2000  forvol    3184.67
  13 │ Germany   2020  forvol    3663.0
  14 │ France    2020  forvol    3055.83
  15 │ Italy     2020  forvol    1424.4
  16 │ Sweden    2020  forvol    3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; longDf2 = stack(data,Not([&quot;Country&quot;,&quot;Year&quot;])) # we specify the variables _not_ to stack (the id variables)</code><code class="nohighlight hljs ansi" style="display:block;">16×4 DataFrame
 Row │ Country  Year   variable  value
     │ String   Int64  String    Float64
─────┼──────────────────────────────────────
   1 │ Germany   2000  forarea     11.354
   2 │ France    2000  forarea     15.288
   3 │ Italy     2000  forarea      8.36925
   4 │ Sweden    2000  forarea     28.163
   5 │ Germany   2020  forarea     11.419
   6 │ France    2020  forarea     17.253
   7 │ Italy     2020  forarea      9.56613
   8 │ Sweden    2020  forarea     27.98
   9 │ Germany   2000  forvol    3381.0
  10 │ France    2000  forvol    2254.28
  11 │ Italy     2000  forvol    1058.71
  12 │ Sweden    2000  forvol    3184.67
  13 │ Germany   2020  forvol    3663.0
  14 │ France    2020  forvol    3055.83
  15 │ Italy     2020  forvol    1424.4
  16 │ Sweden    2020  forvol    3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; longDf3 = stack(data)                         # automatically stack all numerical variables</code><code class="nohighlight hljs ansi" style="display:block;">16×4 DataFrame
 Row │ Country  Year   variable  value
     │ String   Int64  String    Float64
─────┼──────────────────────────────────────
   1 │ Germany   2000  forarea     11.354
   2 │ France    2000  forarea     15.288
   3 │ Italy     2000  forarea      8.36925
   4 │ Sweden    2000  forarea     28.163
   5 │ Germany   2020  forarea     11.419
   6 │ France    2020  forarea     17.253
   7 │ Italy     2020  forarea      9.56613
   8 │ Sweden    2020  forarea     27.98
   9 │ Germany   2000  forvol    3381.0
  10 │ France    2000  forvol    2254.28
  11 │ Italy     2000  forvol    1058.71
  12 │ Sweden    2000  forvol    3184.67
  13 │ Germany   2020  forvol    3663.0
  14 │ France    2020  forvol    3055.83
  15 │ Italy     2020  forvol    1424.4
  16 │ Sweden    2020  forvol    3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; longDf == longDf2 == longDf3</code><code class="nohighlight hljs ansi" style="display:block;">true</code></pre><p>Note how the columns <code>variable</code> and <code>value</code> have been added automatically to host the stachked data</p><h3 id="Unstacking-columns:-from-*wide*-to-*long*"><a class="docs-heading-anchor" href="#Unstacking-columns:-from-*wide*-to-*long*">Unstacking columns: from <em>wide</em> to <em>long</em></a><a id="Unstacking-columns:-from-*wide*-to-*long*-1"></a><a class="docs-heading-anchor-permalink" href="#Unstacking-columns:-from-*wide*-to-*long*" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; wideDf = unstack(longDf,[&quot;Country&quot;,&quot;Year&quot;],&quot;variable&quot;,&quot;value&quot;) # args: df, [cols to remains cols also in the wide layout], column with the ids to expand horizontally and column with the relative values</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64?  Float64?
─────┼────────────────────────────────────
   1 │ Germany   2000  11.354     3381.0
   2 │ France    2000  15.288     2254.28
   3 │ Italy     2000   8.36925   1058.71
   4 │ Sweden    2000  28.163     3184.67
   5 │ Germany   2020  11.419     3663.0
   6 │ France    2020  17.253     3055.83
   7 │ Italy     2020   9.56613   1424.4
   8 │ Sweden    2020  27.98      3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; wideDf2 = unstack(longDf,&quot;variable&quot;,&quot;value&quot;) # cols to remains cols also in the wide layout omitted: all cols not to expand and relative value col remains as col</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Country  Year   forarea   forvol
     │ String   Int64  Float64?  Float64?
─────┼────────────────────────────────────
   1 │ Germany   2000  11.354     3381.0
   2 │ France    2000  15.288     2254.28
   3 │ Italy     2000   8.36925   1058.71
   4 │ Sweden    2000  28.163     3184.67
   5 │ Germany   2020  11.419     3663.0
   6 │ France    2020  17.253     3055.83
   7 │ Italy     2020   9.56613   1424.4
   8 │ Sweden    2020  27.98      3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; wideDf == wideDf2 == data</code><code class="nohighlight hljs ansi" style="display:block;">true</code></pre><p>While the DataFrames package doesn&#39;t support multiple axis we can still arrive to the table below with a little bit of work by unstacking different columns in separate wide dataframes and then joining or horizontally concatenating them:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; wideArea = unstack(data,&quot;Country&quot;,&quot;Year&quot;,&quot;forarea&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">4×3 DataFrame
 Row │ Country  2000      2020
     │ String   Float64?  Float64?
─────┼─────────────────────────────
   1 │ Germany  11.354    11.419
   2 │ France   15.288    17.253
   3 │ Italy     8.36925   9.56613
   4 │ Sweden   28.163    27.98</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; wideVols = unstack(data,&quot;Country&quot;,&quot;Year&quot;,&quot;forvol&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">4×3 DataFrame
 Row │ Country  2000      2020
     │ String   Float64?  Float64?
─────┼─────────────────────────────
   1 │ Germany   3381.0    3663.0
   2 │ France    2254.28   3055.83
   3 │ Italy     1058.71   1424.4
   4 │ Sweden    3184.67   3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rename!(wideArea,[&quot;Country&quot;,&quot;area_2000&quot;,&quot;area_2020&quot;])</code><code class="nohighlight hljs ansi" style="display:block;">4×3 DataFrame
 Row │ Country  area_2000  area_2020
     │ String   Float64?   Float64?
─────┼───────────────────────────────
   1 │ Germany   11.354     11.419
   2 │ France    15.288     17.253
   3 │ Italy      8.36925    9.56613
   4 │ Sweden    28.163     27.98</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; rename!(wideVols,[&quot;Country&quot;,&quot;vol_2000&quot;,&quot;vol_2020&quot;])</code><code class="nohighlight hljs ansi" style="display:block;">4×3 DataFrame
 Row │ Country  vol_2000  vol_2020
     │ String   Float64?  Float64?
─────┼─────────────────────────────
   1 │ Germany   3381.0    3663.0
   2 │ France    2254.28   3055.83
   3 │ Italy     1058.71   1424.4
   4 │ Sweden    3184.67   3653.91</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; wideWideDf = outerjoin(wideArea,wideVols,on=&quot;Country&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">4×5 DataFrame
 Row │ Country  area_2000  area_2020  vol_2000  vol_2020
     │ String   Float64?   Float64?   Float64?  Float64?
─────┼───────────────────────────────────────────────────
   1 │ Germany   11.354     11.419     3381.0    3663.0
   2 │ France    15.288     17.253     2254.28   3055.83
   3 │ Italy      8.36925    9.56613   1058.71   1424.4
   4 │ Sweden    28.163     27.98      3184.67   3653.91</code></pre><h2 id="The-Split-Apply-Combine-strategy"><a class="docs-heading-anchor" href="#The-Split-Apply-Combine-strategy">The Split-Apply-Combine strategy</a><a id="The-Split-Apply-Combine-strategy-1"></a><a class="docs-heading-anchor-permalink" href="#The-Split-Apply-Combine-strategy" title="Permalink"></a></h2><p>Aka &quot;divide and conquer&quot;. Rather than try to modify the dataset direclty, we first split it in subparts, we work on each subpart and then we recombine them in a target dataset</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using Statistics # for `mean`</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; groupby(data,[&quot;Country&quot;,&quot;Year&quot;]) # The &quot;split&quot; part</code><code class="nohighlight hljs ansi" style="display:block;">GroupedDataFrame with 8 groups based on keys: Country, Year
First Group (1 row): Country = &quot;Germany&quot;, Year = 2000
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   1 │ Germany   2000   11.354   3381.0
⋮
Last Group (1 row): Country = &quot;Sweden&quot;, Year = 2020
 Row │ Country  Year   forarea  forvol
     │ String   Int64  Float64  Float64
─────┼──────────────────────────────────
   1 │ Sweden    2020    27.98  3653.91</code></pre><p>Aggregation:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; combine(groupby(data,[&quot;Year&quot;]) ,  &quot;forarea&quot; =&gt; sum =&gt; &quot;sum_area&quot;, &quot;forvol&quot; =&gt; sum =&gt; &quot;sum_vol&quot;, nrow)</code><code class="nohighlight hljs ansi" style="display:block;">2×4 DataFrame
 Row │ Year   sum_area  sum_vol   nrow
     │ Int64  Float64   Float64   Int64
─────┼──────────────────────────────────
   1 │  2000   63.1743   9878.66      4
   2 │  2020   66.2181  11797.1       4</code></pre><p>...or...</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; combine(groupby(data,[&quot;Year&quot;])) do subdf # slower
           (sumarea = sum(subdf.forarea), sumvol = sum(subdf.forvol), nCountries = size(subdf,1))
       end</code><code class="nohighlight hljs ansi" style="display:block;">2×4 DataFrame
 Row │ Year   sumarea  sumvol    nCountries
     │ Int64  Float64  Float64   Int64
─────┼──────────────────────────────────────
   1 │  2000  63.1743   9878.66           4
   2 │  2020  66.2181  11797.1            4</code></pre><p>Cumulative computation:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; a = combine(groupby(data,[&quot;Year&quot;])) do subdf # slower
           (country = subdf.Country, area = subdf.forarea, cumArea = cumsum(subdf.forarea))
       end</code><code class="nohighlight hljs ansi" style="display:block;">8×4 DataFrame
 Row │ Year   country  area      cumArea
     │ Int64  String   Float64   Float64
─────┼───────────────────────────────────
   1 │  2000  Germany  11.354    11.354
   2 │  2000  France   15.288    26.642
   3 │  2000  Italy     8.36925  35.0112
   4 │  2000  Sweden   28.163    63.1743
   5 │  2020  Germany  11.419    11.419
   6 │  2020  France   17.253    28.672
   7 │  2020  Italy     9.56613  38.2381
   8 │  2020  Sweden   27.98     66.2181</code></pre><p>Note in these examples that while in the aggregation we was returning a <em>single record</em> for each subgroup (hence we did some dimensionality reduction) in the cumulative compuation we still output the whole subgroup, so the combined dataframe in output has the same number of rows as the original dataframe.</p><p>An alternative approach is to use the <code>@linq</code> macro from the <code>DatAFrameMEta</code> package that provide a R&#39;s <code>dplyr</code>-like query language using piped data:</p><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataFramesMeta</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dfCum = @linq data |&gt;
                   groupby([:Year]) |&gt;
                   transform(:cumArea = cumsum(:forarea))</code><code class="nohighlight hljs ansi" style="display:block;">8×5 DataFrame
 Row │ Country  Year   forarea   forvol   cumArea
     │ String   Int64  Float64   Float64  Float64
─────┼────────────────────────────────────────────
   1 │ Germany   2000  11.354    3381.0   11.354
   2 │ France    2000  15.288    2254.28  26.642
   3 │ Italy     2000   8.36925  1058.71  35.0112
   4 │ Sweden    2000  28.163    3184.67  63.1743
   5 │ Germany   2020  11.419    3663.0   11.419
   6 │ France    2020  17.253    3055.83  28.672
   7 │ Italy     2020   9.56613  1424.4   38.2381
   8 │ Sweden    2020  27.98     3653.91  66.2181</code></pre><h2 id="Export-and-saving"><a class="docs-heading-anchor" href="#Export-and-saving">Export and saving</a><a id="Export-and-saving-1"></a><a class="docs-heading-anchor-permalink" href="#Export-and-saving" title="Permalink"></a></h2><h3 id="DataFrame-to-Matrix"><a class="docs-heading-anchor" href="#DataFrame-to-Matrix">DataFrame to Matrix</a><a id="DataFrame-to-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#DataFrame-to-Matrix" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; M = Matrix(data)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 Matrix{Any}:
 &quot;Germany&quot;  2000  11.354    3381.0
 &quot;France&quot;   2000  15.288    2254.28
 &quot;Italy&quot;    2000   8.36925  1058.71
 &quot;Sweden&quot;   2000  28.163    3184.67
 &quot;Germany&quot;  2020  11.419    3663.0
 &quot;France&quot;   2020  17.253    3055.83
 &quot;Italy&quot;    2020   9.56613  1424.4
 &quot;Sweden&quot;   2020  27.98     3653.91</code></pre><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>Attention that if the dataframe contains different types across columns, the inner type of the matrix will be <code>Any</code></p></div></div><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; M = Matrix{Union{Float64,Int64,String}}(data)</code><code class="nohighlight hljs ansi" style="display:block;">8×4 Matrix{Union{Float64, Int64, String}}:
 &quot;Germany&quot;  2000  11.354    3381.0
 &quot;France&quot;   2000  15.288    2254.28
 &quot;Italy&quot;    2000   8.36925  1058.71
 &quot;Sweden&quot;   2000  28.163    3184.67
 &quot;Germany&quot;  2020  11.419    3663.0
 &quot;France&quot;   2020  17.253    3055.83
 &quot;Italy&quot;    2020   9.56613  1424.4
 &quot;Sweden&quot;   2020  27.98     3653.91</code></pre><h3 id="DataFrame-to-Dictionary"><a class="docs-heading-anchor" href="#DataFrame-to-Dictionary">DataFrame to Dictionary</a><a id="DataFrame-to-Dictionary-1"></a><a class="docs-heading-anchor-permalink" href="#DataFrame-to-Dictionary" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; function toDict(df, dimCols, valueCol)
           toReturn = Dict()
           for r in eachrow(df)
               keyValues = []
               [push!(keyValues,r[d]) for d in dimCols]
               toReturn[(keyValues...,)] = r[valueCol]
           end
           return toReturn
       end</code><code class="nohighlight hljs ansi" style="display:block;">toDict (generic function with 1 method)</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dict = toDict(data,[&quot;Country&quot;,&quot;Year&quot;],[&quot;forarea&quot;,&quot;forvol&quot;])</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Any, Any} with 8 entries:
  (&quot;Germany&quot;, 2020) =&gt; DataFrameRow…
  (&quot;Italy&quot;, 2020)   =&gt; DataFrameRow…
  (&quot;Italy&quot;, 2000)   =&gt; DataFrameRow…
  (&quot;Germany&quot;, 2000) =&gt; DataFrameRow…
  (&quot;Sweden&quot;, 2000)  =&gt; DataFrameRow…
  (&quot;France&quot;, 2020)  =&gt; DataFrameRow…
  (&quot;France&quot;, 2000)  =&gt; DataFrameRow…
  (&quot;Sweden&quot;, 2020)  =&gt; DataFrameRow…</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dict[&quot;Germany&quot;,2000][1]</code><code class="nohighlight hljs ansi" style="display:block;">11.354</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; dict[&quot;Germany&quot;,2000][&quot;forvol&quot;]</code><code class="nohighlight hljs ansi" style="display:block;">3381.0</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; toDict(data,[&quot;Country&quot;,&quot;Year&quot;],&quot;forarea&quot;)</code><code class="nohighlight hljs ansi" style="display:block;">Dict{Any, Any} with 8 entries:
  (&quot;Germany&quot;, 2020) =&gt; 11.419
  (&quot;Italy&quot;, 2020)   =&gt; 9.56613
  (&quot;Italy&quot;, 2000)   =&gt; 8.36925
  (&quot;Germany&quot;, 2000) =&gt; 11.354
  (&quot;Sweden&quot;, 2000)  =&gt; 28.163
  (&quot;France&quot;, 2020)  =&gt; 17.253
  (&quot;France&quot;, 2000)  =&gt; 15.288
  (&quot;Sweden&quot;, 2020)  =&gt; 27.98</code></pre><h3 id="DataFrame-to-NamedTuple"><a class="docs-heading-anchor" href="#DataFrame-to-NamedTuple">DataFrame to NamedTuple</a><a id="DataFrame-to-NamedTuple-1"></a><a class="docs-heading-anchor-permalink" href="#DataFrame-to-NamedTuple" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; nT = NamedTuple(Dict([Symbol(c) =&gt; data[:,c]  for c in names(data)]))        # order not necessarily preserved</code><code class="nohighlight hljs ansi" style="display:block;">(Country = [&quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;, &quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;], forvol = [3381.0, 2254.28, 1058.71, 3184.67, 3663.0, 3055.83, 1424.4, 3653.91], Year = [2000, 2000, 2000, 2000, 2020, 2020, 2020, 2020], forarea = [11.354, 15.288, 8.36925, 28.163, 11.419, 17.253, 9.56613, 27.98])</code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; using DataStructures</code><code class="nohighlight hljs ansi" style="display:block;"></code><br/><code class="language-julia-repl hljs" style="display:block;">julia&gt; nT = NamedTuple(OrderedDict([Symbol(c) =&gt; data[:,c]  for c in names(data)])) # order preserved</code><code class="nohighlight hljs ansi" style="display:block;">(Country = [&quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;, &quot;Germany&quot;, &quot;France&quot;, &quot;Italy&quot;, &quot;Sweden&quot;], Year = [2000, 2000, 2000, 2000, 2020, 2020, 2020, 2020], forarea = [11.354, 15.288, 8.36925, 28.163, 11.419, 17.253, 9.56613, 27.98], forvol = [3381.0, 2254.28, 1058.71, 3184.67, 3663.0, 3055.83, 1424.4, 3653.91])</code></pre><h3 id="Saving-as-CSV-file"><a class="docs-heading-anchor" href="#Saving-as-CSV-file">Saving as CSV file</a><a id="Saving-as-CSV-file-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-as-CSV-file" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; CSV.write(&quot;outdata.csv&quot;,data) # see options at the beginning of segment in the import section and `? CSV.write` for specific export options</code><code class="nohighlight hljs ansi" style="display:block;">&quot;outdata.csv&quot;</code></pre><h3 id="Saving-as-OpenDocument-spreadsheet"><a class="docs-heading-anchor" href="#Saving-as-OpenDocument-spreadsheet">Saving as OpenDocument spreadsheet</a><a id="Saving-as-OpenDocument-spreadsheet-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-as-OpenDocument-spreadsheet" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; ods_write(&quot;outdata.ods&quot;,Dict((&quot;myData&quot;,3,2) =&gt; data)) # exported starting on cell B3 of sheet &quot;myData&quot;</code><code class="nohighlight hljs ansi" style="display:block;"></code></pre><h3 id="Saving-as-Excel-spreadsheet"><a class="docs-heading-anchor" href="#Saving-as-Excel-spreadsheet">Saving as Excel spreadsheet</a><a id="Saving-as-Excel-spreadsheet-1"></a><a class="docs-heading-anchor-permalink" href="#Saving-as-Excel-spreadsheet" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs" style="display:block;">julia&gt; XLSX.writetable(&quot;outdata.xlsx&quot;,myData = (collect(eachcol(data)),names(data)))</code><code class="nohighlight hljs ansi" style="display:block;">ERROR: AssertionError: outdata.xlsx already exists.</code></pre><p><a href="https://github.com/sylvaticus/SPMLJ/blob/main/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/0201_-_Wranging_data.jl">View this file on Github</a>.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.13.html">« 0106q - QUIZ 1.13</a><a class="docs-footer-nextpage" href="0202_-_Miscellaneous_topics.html">0202 - Miscellaneous topics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Saturday 23 April 2022 11:27">Saturday 23 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
