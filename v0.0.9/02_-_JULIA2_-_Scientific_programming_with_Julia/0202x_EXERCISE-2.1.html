<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>0202x EXERCISE-2.1 Â· SPMLJ</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-Q39LHCRBB6"></script><script>  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-Q39LHCRBB6', {'page_path': location.pathname + location.search + location.hash});
</script><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">SPMLJ</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Index</a></li><li><span class="tocitem">Lessons</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox"/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">INTRO - Introduction to the course, Julia and ML</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0001_-_Course_presentation.html">0001 - Course presentation</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0002_-_Program.html">0002 - Program</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0003_-_Introduction_to_Julia.html">0003 - Introduction to Julia</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004_-_Introduction_to_ML.html">0004 - Introduction to ML</a></li><li><a class="tocitem" href="../00_-_INTRO_-_Introduction_julia_ml/0004q_-_QUIZ_0.1.html">0004q - QUIZ 0.1</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">JULIA1 - Basic Julia programming</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101_-_Basic_syntax.html">0101 - Basic syntax</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101q_-_QUIZ_1.1.html">0101q - QUIZ 1.1</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0101q_-_QUIZ_1.2.html">0101q - QUIZ 1.2</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0102_-_Types_and_objects.html">0102 - Types and objects</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0102q_-_QUIZ_1.3.html">0102q - QUIZ 1.3</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103_-_Predefined_types.html">0103 - Predefined types</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.4.html">0103q - QUIZ 1.4</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.5.html">0103q - QUIZ 1.5</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0103q_-_QUIZ_1.6.html">0103q - QUIZ 1.6</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104_-_Control_flow_and_functions.html">0104 - Control flow and functions</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104q_-_QUIZ_1.7.html">0104q - QUIZ 1.7</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0104q_-_QUIZ_1.8.html">0104q - QUIZ 1.8</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105_-_Custom_types.html">0105 - Custom types</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105q_-_QUIZ_1.10.html">0105q - QUIZ 1.10</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105q_-_QUIZ_1.9.html">0105q - QUIZ 1.9</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0105x_EXERCISE-1.1.html">0105x EXERCISE-1.1</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106_-_Further_topics.html">0106 - Further topics</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.11.html">0106q - QUIZ 1.11</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.12.html">0106q - QUIZ 1.12</a></li><li><a class="tocitem" href="../01_-_JULIA1_-_Basic_Julia_programming/0106q_-_QUIZ_1.13.html">0106q - QUIZ 1.13</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-3" type="checkbox" checked/><label class="tocitem" for="menuitem-2-3"><span class="docs-label">JULIA2 - Scientific programming with Julia</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="0201_-_Wranging_data.html">0201 - Wranging data</a></li><li><a class="tocitem" href="0202_-_Miscellaneous_topics.html">0202 - Miscellaneous topics</a></li><li class="is-active"><a class="tocitem" href="0202x_EXERCISE-2.1.html">0202x EXERCISE-2.1</a><ul class="internal"><li><a class="tocitem" href="#Instructions"><span>Instructions</span></a></li><li><a class="tocitem" href="#Resolution"><span>Resolution</span></a></li></ul></li><li><a class="tocitem" href="0202x_EXERCISE-2.2.html">0202x EXERCISE-2.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-4" type="checkbox"/><label class="tocitem" for="menuitem-2-4"><span class="docs-label">ML1 - Introduction to Machine Learning</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0301_-_Machine_learning_main_concepts.html">0301 - Machine learning main concepts</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302_-_The_Perceptron_classifier.html">0302 - The Perceptron classifier</a></li><li><a class="tocitem" href="../03_-_ML1_-_Introduction_to_Machine_Learning/0302x_EXERCISE-3.1.html">0302x EXERCISE-3.1</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-5" type="checkbox"/><label class="tocitem" for="menuitem-2-5"><span class="docs-label">NN - Neural Networks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0401_-_Neural_network_architectures.html">0401 - Neural network architectures</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402_-_Implementation_of_neural_networks_workflows.html">0402 - Implementation of neural networks workflows</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.1.html">0402x EXERCISE-4.1</a></li><li><a class="tocitem" href="../04_-_NN_-_Neural_Networks/0402x_EXERCISE-4.2.html">0402x EXERCISE-4.2</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-2-6" type="checkbox"/><label class="tocitem" for="menuitem-2-6"><span class="docs-label">DT - Decision trees based algorithms</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0501_-_Decision_trees_based_algorithms.html">0501 - Decision trees based algorithms</a></li><li><a class="tocitem" href="../05_-_DT_-_Decision_trees_based_algorithms/0502x_EXERCISE-5.1.html">0502x EXERCISE-5.1</a></li></ul></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Lessons</a></li><li><a class="is-disabled">JULIA2 - Scientific programming with Julia</a></li><li class="is-active"><a href="0202x_EXERCISE-2.1.html">0202x EXERCISE-2.1</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="0202x_EXERCISE-2.1.html">0202x EXERCISE-2.1</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/sylvaticus/SPMLJ/blob/master/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/0202x_EXERCISE-2.1.md" title="Edit on GitHub"><span class="docs-icon fab">ï‚›</span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="EXERCISE-2.1:-Fitting-the-growth-of-French-forests"><a class="docs-heading-anchor" href="#EXERCISE-2.1:-Fitting-the-growth-of-French-forests">EXERCISE 2.1: Fitting the growth of French forests</a><a id="EXERCISE-2.1:-Fitting-the-growth-of-French-forests-1"></a><a class="docs-heading-anchor-permalink" href="#EXERCISE-2.1:-Fitting-the-growth-of-French-forests" title="Permalink"></a></h1><p>&nbsp;</p>
<img src="imgs/forestGrowth.jpg" alt="Forest Growth" style="height:250px;"> 
<img src="imgs/forestGrowthCurves.png" alt="Forest Growth curves" style="height:250px;"> 
<p>&nbsp;</p><p>How fast are French forests growing? How much timber can they provide in one hectare? Surely forests provide multiple ecosystem services, but in this (simplified) exercise we focus on the above questions by looking at the so-called &quot;raw data&quot; provided by the French National Forest Inventory, both in terms of individual trees and in terms of inventoried plots, to fit a generic growth model of the forest stands in terms of volumes with respect to the age of the trees.</p><p><strong>Skills employed:</strong></p><ul><li>download and import data from internet</li><li>wrangle tabular data: compute new columns (fields) based on existing one, filter rows (records), join tables</li><li>fit a generic model (curve) with data</li></ul><h2 id="Instructions"><a class="docs-heading-anchor" href="#Instructions">Instructions</a><a id="Instructions-1"></a><a class="docs-heading-anchor-permalink" href="#Instructions" title="Permalink"></a></h2><p>If you have already cloned or downloaded the whole <a href="https://github.com/sylvaticus/SPMLJ/">course repository</a> the folder with the exercise is on <code>[REPOSITORY_ROOT]/lessonsMaterial/02_JULIA2/forestExercise</code>. Otherwise download a zip of just that folder <a href="https://downgit.github.io/#/home?url=https://github.com/sylvaticus/SPMLJ/tree/main/lessonsMaterial/02_JULIA2/forestExercise">here</a>.</p><p>In the folder you will find the file <code>forestExercise.jl</code> containing the julia file that <strong>you will have to complete to implement and run the model</strong> (follow the instructions on that file).  In that folder you will also find the <code>Manifest.toml</code> file. The proposal of resolution below has been tested with the environment defined by that file.   If you are stuck and you don&#39;t want to lookup to the resolution above you can also ask for help in the forum at the bottom of this page. Good luck! </p><h2 id="Resolution"><a class="docs-heading-anchor" href="#Resolution">Resolution</a><a id="Resolution-1"></a><a class="docs-heading-anchor-permalink" href="#Resolution" title="Permalink"></a></h2><p>Click &quot;ONE POSSIBLE SOLUTION&quot; to get access to (one possible) solution for each part of the code that you are asked to implement.</p><hr/><h3 id=")-Setting-up-the-environment..."><a class="docs-heading-anchor" href="#)-Setting-up-the-environment...">1) Setting up the environment...</a><a id=")-Setting-up-the-environment...-1"></a><a class="docs-heading-anchor-permalink" href="#)-Setting-up-the-environment..." title="Permalink"></a></h3><p>Start by setting the working directory to the directory of this file and activate it. If you have the provided <code>Manifest.toml</code> file in the directory, just run <code>Pkg.instantiate()</code>, otherwise manually add the packages <code>Pipe</code>, <code>HTTP</code>, <code>CSV</code>, <code>DataFrames</code>, <code>LsqFit</code>, <code>StatsPlots</code>.</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">cd(@__DIR__)         
using Pkg             
Pkg.activate(&quot;.&quot;)   
# If using a Julia version different than 1.7 please uncomment and run the following line (reproductibility guarantee will hower be lost)
# Pkg.resolve()   
Pkg.instantiate() 
using Random
Random.seed!(123)</code></pre></details><hr/><h3 id=")-Load-the-packages"><a class="docs-heading-anchor" href="#)-Load-the-packages">2) Load the packages</a><a id=")-Load-the-packages-1"></a><a class="docs-heading-anchor-permalink" href="#)-Load-the-packages" title="Permalink"></a></h3><p>Load the packages Pipe, HTTP, CSV, DataFrames, LsqFit, StatsPlots</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">using Pipe, HTTP, CSV, DataFrames, LsqFit, StatsPlots</code></pre></details><hr/><h3 id=")-Load-the-data"><a class="docs-heading-anchor" href="#)-Load-the-data">3) Load the data</a><a id=")-Load-the-data-1"></a><a class="docs-heading-anchor-permalink" href="#)-Load-the-data" title="Permalink"></a></h3><p>Load from internet or from local files the following data:</p><pre><code class="language-julia hljs">ltURL     = &quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/blob/main/lessonsMaterial/02_JULIA2/forestExercise/data/arbres_foret_2012.csv?raw=true&quot; # live individual trees data
dtURL     = &quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/blob/main/lessonsMaterial/02_JULIA2/forestExercise/data/arbres_morts_foret_2012.csv?raw=true&quot; # dead individual trees data
pointsURL = &quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/blob/main/lessonsMaterial/02_JULIA2/forestExercise/data/placettes_foret_2012.csv?raw=true&quot; # plot level data
docURL    = &quot;https://github.com/sylvaticus/IntroSPMLJuliaCourse/blob/main/lessonsMaterial/02_JULIA2/forestExercise/data/documentation_2012.csv?raw=true&quot; # optional, needed for the species label</code></pre><p>If you have choosen to download the data from internet, you can make for each of the dataset a <code>@pipe</code> macro starting with <code>HTTP.get(URL).body</code>, continuing the pipe with <code>CSV.File(_)</code> and end the pipe with a DataFrame object.</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">lt     = @pipe HTTP.get(ltURL).body     |&gt; CSV.File(_) |&gt; DataFrame
dt     = @pipe HTTP.get(dtURL).body     |&gt; CSV.File(_) |&gt; DataFrame
points = @pipe HTTP.get(pointsURL).body |&gt; CSV.File(_) |&gt; DataFrame
doc    = @pipe HTTP.get(docURL).body    |&gt; CSV.File(_) |&gt; DataFrame

# Or import from local...
lt     = CSV.read(&quot;data/arbres_foret_2012.csv&quot;,DataFrame)
dt     = CSV.read(&quot;data/arbres_morts_foret_2012.csv&quot;,DataFrame)
points = CSV.read(&quot;data/placettes_foret_2012.csv&quot;,DataFrame)
doc    = CSV.read(&quot;data/documentation_2012.csv&quot;,DataFrame)</code></pre></details><hr/><h3 id=")-Filter-out-unused-information"><a class="docs-heading-anchor" href="#)-Filter-out-unused-information">4) Filter out unused information</a><a id=")-Filter-out-unused-information-1"></a><a class="docs-heading-anchor-permalink" href="#)-Filter-out-unused-information" title="Permalink"></a></h3><p>These datasets have many variable we are not using in this exercise. Out of all the variables, select only for the <code>lt</code> and <code>dt</code> dataframes the columns <code>idp</code> (pixel id), <code>c13</code> (circumference at 1.30 meters) and <code>v</code> (tree&#39;s volume). Then vertical concatenate the two dataset in an overall <code>trees</code> dataset. For the <code>points</code> dataset, select only the variables <code>idp</code> (pixel id), <code>esspre</code> (code of the main forest species in the stand) and <code>cac</code> (age class).</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">lt     = lt[:,[&quot;idp&quot;,&quot;c13&quot;,&quot;v&quot;]]
dt     = dt[:,[&quot;idp&quot;,&quot;c13&quot;,&quot;v&quot;]]
trees  = vcat(lt,dt)
points = points[:,[&quot;idp&quot;,&quot;esspre&quot;,&quot;cac&quot;]]</code></pre></details><hr/><h3 id=")-Compute-the-timber-volumes-per-hectare"><a class="docs-heading-anchor" href="#)-Compute-the-timber-volumes-per-hectare">5) Compute the timber volumes per hectare</a><a id=")-Compute-the-timber-volumes-per-hectare-1"></a><a class="docs-heading-anchor-permalink" href="#)-Compute-the-timber-volumes-per-hectare" title="Permalink"></a></h3><p>As the French inventory system is based on a concentric sample method (small trees are sampled on a small area (6 metres radius), intermediate trees on a concentric area of 9 metres and only large trees (with a circonference larger than 117.5 cm) are sampled on a concentric area of 15 metres of radius), define the following function to compute the contribution of each tree to the volume per hectare:</p><pre><code class="language-julia hljs">&quot;&quot;&quot;
    vHaContribution(volume,circonference)

Return the contribution in terms of mÂ³/ha of the tree.

The French inventory system is based on a concentric sample method: small trees are sampled on a small area (6 metres radius), intermediate trees on a concentric area of 9 metres and only large trees (with a circonference larger than 117.5 cm) are sampled on a concentric area of 15 metres of radius.
This function normalise the contribution of each tree to mÂ³/ha.
&quot;&quot;&quot;
function vHaContribution(v,c13)
    if c13 &lt; 70.5
        return v/(6^2*pi/(100*100))
    elseif c13 &lt; 117.5
        return v/(9^2*pi/(100*100))
    else 
        return v/(15^2*pi/(100*100))
    end
end</code></pre><p>Use the above function to compute <code>trees.vHa</code> based on <code>trees.v</code> and <code>trees.c13</code>.</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">trees.vHa  = vHaContribution.(trees.v,trees.c13)</code></pre></details><hr/><h3 id=")-Aggregate-trees-data"><a class="docs-heading-anchor" href="#)-Aggregate-trees-data">6) Aggregate trees data</a><a id=")-Aggregate-trees-data-1"></a><a class="docs-heading-anchor-permalink" href="#)-Aggregate-trees-data" title="Permalink"></a></h3><p>Aggregate the <code>trees</code> dataframe by the <code>idp</code> column to retrieve the sum of <code>vHa</code> and the number of trees for each point, calling these two columns <code>vHa</code> and <code>ntrees</code>.</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">pointsVols = combine(groupby(trees,[&quot;idp&quot;]) ,  &quot;vHa&quot; =&gt; sum =&gt; &quot;vHa&quot;, nrow =&gt; &quot;ntrees&quot;)</code></pre></details><hr/><h3 id=")-Join-datasets"><a class="docs-heading-anchor" href="#)-Join-datasets">7) Join datasets</a><a id=")-Join-datasets-1"></a><a class="docs-heading-anchor-permalink" href="#)-Join-datasets" title="Permalink"></a></h3><p>Join the output of the previous step (the trees dataframe aggregated &quot;by point&quot;) with the original points dataframe using the column <code>idp</code>.</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">points     = innerjoin(points,pointsVols,on=&quot;idp&quot;)</code></pre></details><hr/><h3 id=")-Filter-data"><a class="docs-heading-anchor" href="#)-Filter-data">8) Filter data</a><a id=")-Filter-data-1"></a><a class="docs-heading-anchor-permalink" href="#)-Filter-data" title="Permalink"></a></h3><p>Use boolean selection to apply the following filters:</p><pre><code class="language-julia hljs">filter_nTrees           = points.ntrees .&gt; 5 # we skip points with few trees 
filter_IHaveAgeClass    = .! in.(points.cac,Ref([&quot;AA&quot;,&quot;NR&quot;]))
filter_IHaveMainSpecies = .! ismissing.(points.esspre) 
filter_overall          = filter_nTrees .&amp;&amp; filter_IHaveAgeClass .&amp;&amp; filter_IHaveMainSpecies</code></pre><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">points                  = points[filter_overall,:] </code></pre></details><hr/><h3 id=")-Compute-the-age-class"><a class="docs-heading-anchor" href="#)-Compute-the-age-class">9) Compute the age class</a><a id=")-Compute-the-age-class-1"></a><a class="docs-heading-anchor-permalink" href="#)-Compute-the-age-class" title="Permalink"></a></h3><p>Run the following command to parse the age class (originally as a string indicating the 5-ages group) to an integer and compute the mid-range of the class in years. For example, class &quot;02&quot; will become 7.5 years.</p><pre><code class="language-julia hljs">points.cac              = (parse.(Int64,points.cac) .- 1 ) .* 5 .+ 2.5</code></pre><hr/><h3 id=")-Define-the-model-to-fit"><a class="docs-heading-anchor" href="#)-Define-the-model-to-fit">10) Define the model to fit</a><a id=")-Define-the-model-to-fit-1"></a><a class="docs-heading-anchor-permalink" href="#)-Define-the-model-to-fit" title="Permalink"></a></h3><p>Define the following logistic model of the growth relation with respect to the age with 3 parameters and make its vectorised form:</p><pre><code class="language-julia hljs">logisticModel(age,parameters) = parameters[1]/(1+exp(-parameters[2] * (age-parameters[3]) ))
logisticModelVec(age,parameters) = # .... complete here</code></pre><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">logisticModelVec(age,parameters) = logisticModel.(age,Ref(parameters))</code></pre></details><hr/><h3 id=")-Set-the-initial-values-for-the-parameters-to-fit"><a class="docs-heading-anchor" href="#)-Set-the-initial-values-for-the-parameters-to-fit">11) Set the initial values for the parameters to fit</a><a id=")-Set-the-initial-values-for-the-parameters-to-fit-1"></a><a class="docs-heading-anchor-permalink" href="#)-Set-the-initial-values-for-the-parameters-to-fit" title="Permalink"></a></h3><p>Set <code>initialParameters</code> to 1000,0.05 and 50 respectivelly.</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">initialParameters = [1000,0.05,50] #max growth; growth rate, mid age</code></pre></details><hr/><h3 id=")-Fit-the-model"><a class="docs-heading-anchor" href="#)-Fit-the-model">12) Fit the model</a><a id=")-Fit-the-model-1"></a><a class="docs-heading-anchor-permalink" href="#)-Fit-the-model" title="Permalink"></a></h3><p>Perform the fitting of the model using the function <code>curve_fit(model,X,Y,initial parameters)</code> and obtain the fitted parameter <code>fitobject.param</code></p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">fitobject         = curve_fit(logisticModelVec, points.cac, points.vHa, initialParameters)
fitparams         = fitobject.param</code></pre></details><hr/><h3 id=")-Compute-the-errors"><a class="docs-heading-anchor" href="#)-Compute-the-errors">13) Compute the errors</a><a id=")-Compute-the-errors-1"></a><a class="docs-heading-anchor-permalink" href="#)-Compute-the-errors" title="Permalink"></a></h3><p>Compute the standard error for each estimated parameter and the confidence interval at 10% significance level</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">sigma            = stderror(fitobject)
confidence_inter = confidence_interval(fitobject, 0.1) # 10% significance level</code></pre></details><hr/><h3 id=")-Plot-fitted-model"><a class="docs-heading-anchor" href="#)-Plot-fitted-model">14) Plot fitted model</a><a id=")-Plot-fitted-model-1"></a><a class="docs-heading-anchor-permalink" href="#)-Plot-fitted-model" title="Permalink"></a></h3><p>Plot a chart of fitted (y) by stand age (x) (i.e. the logisticModel with the given parameters)</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">x = 0:maximum(points.cac)*1.5
plot(x-&gt;logisticModel(x,fitparams),0,maximum(x), label= &quot;Fitted vols&quot;, legend=:topleft)</code></pre></details><hr/><h3 id=")-Add-the-observations-to-the-plot"><a class="docs-heading-anchor" href="#)-Add-the-observations-to-the-plot">15) Add the observations to the plot</a><a id=")-Add-the-observations-to-the-plot-1"></a><a class="docs-heading-anchor-permalink" href="#)-Add-the-observations-to-the-plot" title="Permalink"></a></h3><p>Add to the plot a scatter chart of the actual observed VHa</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">plot!(points.cac, points.vHa, seriestype=:scatter, label = &quot;Obs vHa&quot;)</code></pre></details><hr/><h3 id=")-[OPTIONAL]-Differentiate-the-model-per-tree-specie"><a class="docs-heading-anchor" href="#)-[OPTIONAL]-Differentiate-the-model-per-tree-specie">16) [OPTIONAL] Differentiate the model per tree specie</a><a id=")-[OPTIONAL]-Differentiate-the-model-per-tree-specie-1"></a><a class="docs-heading-anchor-permalink" href="#)-[OPTIONAL]-Differentiate-the-model-per-tree-specie" title="Permalink"></a></h3><p>Look at the growth curves of individual species. Try to perform the above analysis for individual species, for example plot the fitted curves for the 5 most common species</p><details><summary>ONE POSSIBLE SOLUTION</summary><pre><code class="language-julia hljs">speciesCount = combine(groupby(points, :esspre), nrow =&gt; :count)
sort!(speciesCount,&quot;count&quot;,rev=true)

spLabel        = doc[doc.donnee .== &quot;ESSPRE&quot;,:]
spLabel.spCode = parse.(Int64,spLabel.code)
speciesCount = leftjoin(speciesCount,spLabel, on=&quot;esspre&quot; =&gt; &quot;spCode&quot;)


# plot the 5 main species separately
for (i,sp) in enumerate(speciesCount[1:5,&quot;esspre&quot;])
    local fitobject, fitparams, x
    spLabel    = speciesCount[i,&quot;libelle&quot;]
    pointsSp   = points[points.esspre .== sp, : ]
    fitobject  = curve_fit(logisticModelVec, pointsSp.cac, pointsSp.vHa, initialParameters)
    fitparams  = fitobject.param
    x = 0:maximum(points.cac)*1.5
    println(i)
    println(sp)
    println(fitparams)
    if i == 1
        myplot = plot(x-&gt;logisticModel(x,fitparams),0,maximum(x), label= spLabel, legend=:topleft)
    else
        myplot = plot!(x-&gt;logisticModel(x,fitparams),0,maximum(x), label= spLabel, legend=:topleft)
    end
    display(myplot)
end</code></pre></details><hr/><div id="pd_rating_holder_8962705"></div>
<script type="text/javascript">
PDRTJS_settings_8962705 = {
"id" : "8962705",
"unique_id" : "/home/runner/work/SPMLJ/SPMLJ/lessonsSources/02_-_JULIA2_-_Scientific_programming_with_Julia/0202x_EXERCISE-2.1.md",
"title" : "0202x_EXERCISE-2.1.md",
"permalink" : ""
};
</script><div class="addthis_inline_share_toolbox"></div><hr/><script src="https://utteranc.es/client.js"
        repo="sylvaticus/SPMLJ"
        issue-term="title"
        label="ðŸ’¬ website_comment"
        theme="github-dark"
        crossorigin="anonymous"
        async>
</script><script type="text/javascript" charset="utf-8" src="https://polldaddy.com/js/rating/rating.js"></script><!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-6256c971c4f745bc"></script></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="0202_-_Miscellaneous_topics.html">Â« 0202 - Miscellaneous topics</a><a class="docs-footer-nextpage" href="0202x_EXERCISE-2.2.html">0202x EXERCISE-2.2 Â»</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Sunday 24 April 2022 14:10">Sunday 24 April 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
